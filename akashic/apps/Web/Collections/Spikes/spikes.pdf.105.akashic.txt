these coefficients known as the fast Fourier Transform, which is implemented in MatLab  as the function fft. The Fourier power spectrum is simply the square of the amplitude of  each frequency term in the Fourier transform. If a time series is either periodic or quasi- periodic, its Fourier power spectrum will have large peaks at the dominant frequencies.  The script ChaosTester.m includes time series that are both periodic and quasiperiodic.  Running the program and choosing either of these options will produce a Fourier power  spectrum with two large peaks reflecting the two frequencies in (11.1) and (11.2). (Choose  0 for the first return map value, which will be discussed below.) Note that the power  spectrum is plotted on semi-logarithmic coordinates, so the peaks are about 105 times  higher than the background noise.  Turning to the simulation of (11.3) using Lorenz.m, all computed values for x{t), ylt),  and r(?) remain in MatLab's memory after a program is run, so the results can be analyzed  by running ChaosTester.m after Lorenz.m. The variable z(t) will be chosen as the time  series for analysis, and 25 is an appropriate value for calculating the first return map. The  Fourier power spectrum is plotted at the bottom of Fig. 11.2. There are clearly a vast  number of frequencies in the spectrum, and their mean amplitude falls off smoothly  as frequency increases. Such an amplitude spectrum is one characteristic signature  of chaos.  The second test for chaos requires computation of the first return map. Given a time  series such as z(t) obtained from solving (11.3), one chooses a value zo and measures  all the intervals between the times when z(t) returns to this same value as z(t) is increasing.  These intervals between successive times T, when the time series passes zo are called first  return times. A two-dimensional graph can now be generated by plotting T,+ \ as a  function of 77,. This is called a first return map. The program (ChaosTester.m produces the  first return map shown at the top of Fig. 11.2 for z(t) from (11.3) when z0 = 25. Clearly,  the return map does not cover all possible values but rather produces a complex shape that  is characteristic of chaos. Experimentation with ChaosTester.m shows that an oscillation  produces a first return map with only one or a small number of points. In the simplest  oscillatory case there is only one point, because all first return values are equal to the  period. Random noise fills the space eventually, because there is no correlation between  successive return times, although there is a bias towards shorter return times when the  noise is normally distributed. Finally, a quasiperiodic trajectory will produce a first return  map that is a simple ellipse. The reason is that a quasiperiodic trajectory fills the surface of  178  Spikes, decisions, and actions  +  K- F  - i  0)  rr  ^zu  110  100  90  BU  70  60  z = 25  : i "  •:.  * '   :!::-=-:••:  60  80  100  Return(T)  120  0  1000  2000  3000  4000  5000  Frequency  Fig. 11.2 First return map (top) and Fourier power spectrum (bottom) for the Lorenz equations (11.3).  a torus, and the first return map effectively cuts a cross-section of that torus. Thus, chaotic  trajectories or time series exhibit a distinguishing structure in their first return maps.  The final chaos test is based on one of the defining elements of chaos: sensitive  dependence on initial conditions such that neighboring trajectories diverge exponentially.  The average exponent of this rate of divergence is called a Lyapunov exponent. To cal- culate the Lyapunov exponent, it is generally necessary to use the differential equations  defining a dynamical model. Suppose we calculate one trajectory of (11.3) that we wish to  examine for chaos. We must next measure the rate of divergence of neighboring trajec- tories all along this one trajectory. Conceptually, this is done by choosing an initial  condition that differs by a very small amount A, perhaps 10~5 from the value used to  generate the original trajectory. We now solve the equations for one time iteration 6t of  the Runge-Kutta routine and measure the Euclidean distance A\ between the new  solution and the original one. The ratio Ai/A is an accurate measure of the divergence 