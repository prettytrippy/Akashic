series to expand the last term in (5.9), retaining only the first order term:  dFdx  dF  Fix + chF) « F(x) + h — — = Fix) + h — cF  (5.10)  d.v d/i  d.v  Substituting this into (5.9) gives:  dF  x(tN + h) « A + (a + b)hF+bch2F —  (5.11)  Looking at (5.8) and (5.11), one can see that the two will be identical if:  a + b=\  and  be = \  (5.12)  Note that these conditions on a, b, and c do not uniquely specify the solution, so one more  equation is needed. As there is no mathematical reason for preferring one choice over any  other, aesthetic considerations are usually indulged by setting a = b. Therefore, (5.12)  yields: a = 1/2; b = 1/2; and c = 1. Using these values in (5.9) gives:  x{tN + h)*x  + ^F+^F(x  + hF)  (5.13)  We have now shown that (5.13) is identical to the second order Taylor expansion in (5.6)  and (5.7), but (5.13) only involves the function Fand none of its derivatives.  Equation (5.13) is the second order Runge-Kutta approximation. Although (5.13)  may seem strange, it actually has a very simple and intuitive interpretation. Recall from  (5.1) that F=dx/dt.  Substitution of this relationship back in the two occurrences of  64  Spikes, decisions, and actions  Fin (5.13) yields:  h dx  h I  , dx  AN  + h)*x  + - -  + -F(x +  h - so  h (dxN  dxAr+i]  x(?„ + /?)«x + - | — + — j  (5.14)  This indicates that the second order Runge-Kutta approximation to x( ? + /z) is similar to  the Euler method in (5.4), except that two estimates of the slope are obtained and aver- aged. The first estimate is obtained at ?#, and the second one is obtained based on Euler's  approximation of x(?/v + h).  Let us look at this graphically using a very simple equation:  ^ = - 7 5  W l t h  *(°) = ]  (5-15)  We shall take It = 4 ms, which is large but will emphasize the principle of the Runge-Kutta  method. This proceeds through four steps (a-d) to approximate x(h) = x(4) from x(0).  (a) Calculate the slope F(x(0)) (depicted at (1) in Fig. 5.2 as a heavy line):  nm)^-i  (5..6)  (b) Use this estimate to compute a first approximation of Xi(4) using the equivalent of  Euler's formula (5.4) (open point at (2) in Fig. 5.2):  x, (4) * x(0) +/iF(x(0)) = 1 + 4 ( - T V ) = 0.6  (5.17)  (c) Now use xi(4) to compute a second estimate of the slope F(x(4)) (heavy line at (3) in  Fig. 5.2):  F ( x l ( 4 ) ) = ^ = - ^ = - 0 . 0 6  (5.18)  (d) As indicated in (5.14) F(x(0)) and F(x, (4)) from (5.16) and (5.18) are now averaged to  obtain the second order Runge-Kutta estimate of x(4) (solid point at (4) in Fig. 5.2):  x(4) « x(0) + - {F(A(0)) + F(.v, (4))} = 1 + A- (-0.10 - 0.06) = 0.68  (5.19)  These four steps are shown in Fig. 5.2 along with both the Euler approximation (dotted  line) and the second order Runge-Kutta solution (dashed line). These approximations 