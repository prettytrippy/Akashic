of this neighboring trajectory. Thus, if Ai/A > 1 the trajectory is diverging from the  Neural chaos  179  Neighboring  Trajectory  Original  Trajectory  St  26t  38t  Time  Fig. 11.3 Illustration of Lyapunov exponent computation. A neighboring trajectory, beginning a small  distance A away from the original trajectory, is computed for one time step, and the resultant distance from  the original trajectory, A| is then determined. The procedure is repeated for the duration of the original  trajectory. The results are averaged in (11.5) to determine the Lyapunov exponent.  original trajectory, while if A\ / A < 1 the trajectory is converging. These possibilities are  associated with instability and asymptotic stability of the original trajectory. To complete  calculation of the Lyapunov exponent, this process must be repeated at point after point  along the trajectory and the results averaged. This is done by choosing successive con- ditions that are all at distance A from successive points on our original trajectory but in  the direction of A,. The nature of this computation is illustrated schematically in Fig. 11.3.  The assumption in calculating an exponent is that neighboring trajectories converge or  diverge as eA*', where the Lyapunov exponent is A. Therefore, the natural logarithms of  successive A,/A ratios must be averaged and divided by the Runge-Kutta time increment  St. The resulting formula for the Lyapunov exponent A of a trajectory computed at N time  points is:  1 SK*  N6t  (11.5)  There are actually as many Lyapunov exponents as there are dimensions of the dynamical  system, three in the case of (11.3). However, chaotic dependence on initial conditions is  determined by whether or not the largest of these is positive, and (11.5) provides a means  for computing the largest exponent. Computing all of the exponents requires linearizing  around every point on the original trajectory and solving for the local eigenvalues, a much  more tedious task.  The MatLab program LyapunovExpt.m implements the computation of (11.5) for the  Lorenz equations (11.3). First, it is necessary to run a Runge-Kutta simulation using  Lorenz.m to obtain the trajectory to be analyzed, which MatLab will keep in memory. The  calculated trajectory can now be analyzed by the program LyapunovExpt.m. The program  180  Spikes, decisions, and actions  will ask for the value of A, which should be small (e.g. 10~5), but not so small as to cause  problems with round-off errors in the computation. For the Lorenz equations (11.3) you  will find that A is around 0.9, the exact value depending on the length of trajectory  analyzed. As A > 0, neighboring trajectories diverge exponentially from one another, and  the system is therefore very sensitive to slight variations in initial conditions. This is a  defining characteristic of chaos.  To sum up, three separate tests for chaos have been presented. Any chaotic system  will have a very complex power spectrum with virtually all frequencies present and  with power decreasing with increasing frequency. In contrast, the presence of a few  very prominent peaks is indicative of either periodic or quasiperiodic behavior. A chaotic  system will also produce a first return map with a complex structure that fills only a  small portion of the plot. Periodic systems will produce a small number of isolated  points (perhaps only one!), and quasiperiodic systems will generally form a solid closed  curve, such as an ellipse produced by cutting the surface of a doughnut. Finally, a chaotic  system must have a Lyapunov exponent A > 0. Asymptotically stable trajectories, such  as limit cycles, will have A < 0. If the trajectories of a system satisfy all three criteria for  chaos, we can be certain that the dynamics are indeed chaotic. When dealing with  experimentally measured time series, however, it is sometimes quite difficult to be certain  of chaos, because a deterministic physical system with added noise can sometimes pro- duce non-chaotic trajectories that are seemingly chaotic by our tests. Furthermore,  measurement of the Lyapunov exponent is generally not possible for experimental data.  As the focus in this book is on deterministic mathematical models in neurobiology,  problems of testing noisy experimental time series for chaos will not be discussed, and  the interested reader is referred to Kaplan and Glass (1995).  11.3 Hodgkin-Huxley equations and chaos  The Lorenz equations were chosen to provide a focus for characterizing chaos, because 